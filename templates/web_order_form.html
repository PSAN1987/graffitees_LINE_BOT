<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="UTF-8">
  <title>WEBフォーム注文</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <style>
    body {
      margin: 0; padding: 0;
      font-family: sans-serif;
      background-color: #ffeef2; /* 淡いピンク */
    }
    .container {
      max-width: 600px;
      margin: 0 auto;
      padding: 1em;
      background-color: #fff;
      border-radius: 8px;
    }
    h1 {
      text-align: center;
      color: #d15b8f;
    }
    .form-group {
      margin-bottom: 1em;
    }
    .form-group label {
      display: block;
      margin-bottom: 0.3em;
      font-weight: bold;
    }
    .form-group select,
    .form-group input[type="text"],
    .form-group input[type="number"],
    .form-group input[type="date"] {
      width: 100%;
      padding: 0.5em;
      box-sizing: border-box;
      border: 1px solid #ccc;
      border-radius: 4px;
    }
    .size-inputs {
      display: flex;
      flex-wrap: wrap;
      gap: 1em;
    }
    .size-inputs .sub-group {
      flex: 1;
      min-width: 100px;
    }
    .sub-group { margin-bottom: 0.5em; }
    .hidden { display: none; }
    .submit-btn {
      text-align: center;
      margin-top: 2em;
    }
    .submit-btn button {
      background-color: #d15b8f;
      color: #fff;
      border: none;
      padding: 1em 2em;
      border-radius: 4px;
      font-size: 1em;
      cursor: pointer;
    }
    .submit-btn button:hover {
      opacity: 0.8;
    }
    fieldset {
      border: 1px solid #ccc;
      padding: 1em;
      margin-bottom: 1em;
    }
    legend { font-weight: bold; }
    .inline-flex {
      display: flex;
      align-items: center;
      gap: 0.5em;
    }
    .mt1 { margin-top: 1em; }
    .mb1 { margin-bottom: 1em; }
  </style>
  <script src="https://static.line-scdn.net/liff/edge/2/sdk.js"></script>
</head>
<body>
<div class="container">
  <h1>WEBフォーム注文</h1>
  <!-- 送信先: /submit_web_order_form  /  POST で送る -->
  <form id="orderForm" action="/submit_web_order_form" method="post">
  <input type="hidden" name="lineUserId" id="lineUserId">
  <!-- CSRF 用ワンタイムトークン -->
  <input type="hidden" name="form_token" value="{{ token }}">
    <!-- ▼ 製品選択（商品名 → 品番 → カラーNo → 商品カラー）▼ -->
    <div class="form-group">
      <label for="productNameSelect">商品名 <span style="color:red;">(必須)</span></label>
      <select id="productNameSelect" name="productName" required>
        <option value="">選択してください</option>
      </select>
    </div>

    <div class="form-group">
      <label for="productNoSelect">品番 <span style="color:red;">(必須)</span></label>
      <select id="productNoSelect" name="productNo" required>
        <option value="">選択してください</option>
      </select>
    </div>

    <div class="form-group">
      <label for="colorNoSelect">カラーNo <span style="color:red;">(必須)</span></label>
      <select id="colorNoSelect" name="colorNo" required>
        <option value="">選択してください</option>
      </select>
    </div>

    <div class="form-group">
      <label for="colorNameSelect">商品カラー <span style="color:red;">(必須)</span></label>
      <select id="colorNameSelect" name="colorName" required>
        <option value="">選択してください</option>
      </select>
    </div>

    <!-- ▼ サイズ毎の枚数入力 ▼ -->
    <div class="form-group">
      <label>サイズ毎の枚数 <span style="color:red;">(必須)</span></label>
      <div class="size-inputs">
        <div class="sub-group">
          <label for="size150">150</label>
          <input type="number" id="size150" name="size150" value="0" min="0" required oninput="calculateTotal()">
        </div>
        <div class="sub-group">
          <label for="sizeSS">SS(160)</label>
          <input type="number" id="sizeSS" name="sizeSS" value="0" min="0" required oninput="calculateTotal()">
        </div>
        <div class="sub-group">
          <label for="sizeS">S</label>
          <input type="number" id="sizeS" name="sizeS" value="0" min="0" required oninput="calculateTotal()">
        </div>
        <div class="sub-group">
          <label for="sizeM">M</label>
          <input type="number" id="sizeM" name="sizeM" value="0" min="0" required oninput="calculateTotal()">
        </div>
        <div class="sub-group">
          <label for="sizeL">L(F)</label>
          <input type="number" id="sizeL" name="sizeL" value="0" min="0" required oninput="calculateTotal()">
        </div>
        <div class="sub-group">
          <label for="sizeXL">LL(XL)</label>
          <input type="number" id="sizeXL" name="sizeXL" value="0" min="0" required oninput="calculateTotal()">
        </div>
        <div class="sub-group">
          <label for="sizeXXL">3L(XXL)</label>
          <input type="number" id="sizeXXL" name="sizeXXL" value="0" min="0" required oninput="calculateTotal()">
        </div>
      </div>
    </div>

    <div class="form-group">
      <label for="totalQuantity">合計枚数</label>
      <input type="number" id="totalQuantity" name="totalQuantity" value="0" readonly>
    </div>

    <!-- ▼ プリント位置のイメージ画像 ▼ -->
    <div class="form-group">
      <label>プリント位置イメージ</label>
      <!-- 任意のURLに差し替え可能 -->
      <img src="https://catalog-bot-zf1t.onrender.com/PRINT_LOCATION.png" alt="プリント位置イメージ" style="max-width:80%;">
    </div>

    <!-- ▼ 1ヵ所目のプリント設定（必須）▼ -->
    <fieldset id="printLocation1">
      <legend>1ヵ所目のプリント設定 (必須)</legend>
      <div class="sub-group">
        <label for="printPositionNo1">プリント位置No.</label>
        <select id="printPositionNo1" name="printPositionNo1" required onchange="toggleNameNumberOptions(1)">
          <option value="">選択</option>
          <option value="1">1</option>
          <option value="2">2</option>
          <option value="3">3</option>
          <option value="4">4</option>
          <option value="5">5</option>
          <option value="6">6</option>
          <option value="7">7</option>
        </select>
      </div>

      <!-- ネーム&番号プリント種別 (位置No.が6 or 7の時だけ表示) -->
      <div id="nameNumberOptions1" class="sub-group hidden">
        <label>ネーム＆番号プリント</label>
        <select name="nameNumberOption1" id="nameNumberOption1" onchange="toggleNameNumberColorBox(1)">
          <option value="">選択</option>
          <option value="nameNumberSet">ネーム＆背番号セット</option>
          <option value="nameLarge">ネーム(大)</option>
          <option value="nameSmall">ネーム(小)</option>
          <option value="numberLarge">番号(大)</option>
          <option value="numberSmall">番号(小)</option>
        </select>
      </div>
      <!-- ネーム&番号プリントカラーオプション -->
      <div id="nameNumberPrintColorBox1" class="sub-group hidden" style="border:1px solid #ccc; padding:0.5em;">
        <strong>ネーム・番号プリントカラーオプション</strong>
        <div class="inline-flex mt1 mb1">
          <label><input type="radio" name="nameNumberPrintType1" value="single" checked onclick="toggleEdgeColor(1)"> 単色</label>
          <label><input type="radio" name="nameNumberPrintType1" value="edge" onclick="toggleEdgeColor(1)"> フチ付き</label>
        </div>
        <!-- 単色 -->
        <div id="singleColorSelectArea1" class="sub-group">
          <label>単色カラー</label>
          <select id="singleColor1" name="singleColor1">
            <!-- JSで動的に追加 -->
          </select>
        </div>
        <!-- フチ付き -->
        <div id="edgeColorSelectArea1" class="sub-group hidden">
          <label>フチ付きタイプ</label>
          <select id="edgeType1" name="edgeType1" onchange="changeEdgeType(1)">
            <option value="">選択してください</option>
            <option value="FT-1">FT-1 (文字色ブラック、フチ色1ブラック)</option>
            <option value="FT-2">FT-2 (文字色ホワイト、フチ色1ブラック)</option>
            <option value="FT-3">FT-3 (文字色レッド、フチ色1ブラック)</option>
            <option value="FT-4">FT-4 (文字色パープル、フチ色1イエロー)</option>
            <option value="FT-5">FT-5 (文字色ブラック、フチ色1ホワイト、フチ色2ブラック)</option>
            <option value="FT-6">FT-6 (文字色レッド、フチ色1ホワイト、フチ色2ブラック)</option>
            <option value="FT-7">FT-7 (文字色ブルー、フチ色1ホワイト、フチ色2ブルー)</option>
            <option value="FT-8">FT-8 (文字色ブルー、フチ色1ホワイト、フチ色2レッド)</option>
            <option value="custom">カスタム</option>
          </select>
          <div id="edgeColorCustomArea1" class="hidden" style="margin-top:0.5em;">
            <label>文字色</label>
            <select id="edgeCustomTextColor1" name="edgeCustomTextColor1"></select>
            <label>フチ色1</label>
            <select id="edgeCustomEdgeColor1" name="edgeCustomEdgeColor1"></select>
            <label>フチ色2 (任意)</label>
            <select id="edgeCustomEdgeColor2_1" name="edgeCustomEdgeColor2_1"></select>
          </div>
        </div>
        <!-- フォント -->
        <div class="sub-group mt1">
          <label>フォント選択</label>
          <div class="inline-flex mb1">
            <label><input type="radio" name="fontType1" value="E" checked> 英数字対応 (E-)</label>
            <label><input type="radio" name="fontType1" value="J"> 日本語対応 (J-)</label>
          </div>
          <div class="inline-flex">
            <span id="fontPrefix1">E-</span>
            <input type="text" id="fontNumber1" name="fontNumber1" maxlength="2" style="width:3em;" placeholder="00">
          </div>
        </div>
      </div>

      <!-- 通常のプリントカラー・オプション (1色目, 2色目, 3色目, フルカラー) -->
      <div class="sub-group">
        <label>プリントカラー・オプション</label>
        <select name="printColorOption1_1" id="printColorOption1_1">
          <option value="">1色目を選択</option>
        </select>
        <select name="printColorOption1_2" id="printColorOption1_2">
          <option value="">2色目を選択</option>
        </select>
        <select name="printColorOption1_3" id="printColorOption1_3">
          <option value="">3色目を選択</option>
        </select>
        <!-- フルカラー -->
        <select name="fullColorSize1">
          <option value="">フルカラーを選択</option>
          <option value="S">フルカラー(小)</option>
          <option value="M">フルカラー(中)</option>
          <option value="L">フルカラー(大)</option>
        </select>
      </div>

      <!-- デザイン番号 -->
      <div class="sub-group">
        <label for="designCode1">デザイン (例: D-001)</label>
        <div style="display:flex; gap:0.3em;">
          <span>D-</span>
          <input type="text" id="designCode1" name="designCode1" maxlength="3" style="width:4em;" placeholder="3桁">
        </div>
      </div>

      <!-- デザインサイズ -->
      <div class="sub-group">
        <label>デザインサイズ</label>
        <select name="designSize1" id="designSize1" onchange="toggleCustomSize(1)">
          <option value="max">プリント位置最大</option>
          <option value="custom">任意のサイズ</option>
        </select>
        <div id="customSizeInput1" class="hidden">
          <label>X(cm)</label>
          <input type="number" name="designSizeX1" min="0" step="0.1" style="width:5em;">
          <label>Y(cm)</label>
          <input type="number" name="designSizeY1" min="0" step="0.1" style="width:5em;">
        </div>
      </div>
    </fieldset>

    <!-- ▼ 追加プリント箇所を動的に生成する領域 & 追加ボタン ▼ -->
    <div id="additionalPrintLocations"></div>

    <div style="margin-bottom:2em;">
      <button type="button" onclick="addPrintLocation()">+ プリント箇所を追加</button>
    </div>

    <!-- ▼ 希望お届け日・使用日・申込日 ▼ -->
    <div class="form-group">
      <label for="deliveryDate">希望お届け日 <span style="color:red;">(必須)</span></label>
      <input type="date" id="deliveryDate" name="deliveryDate" required />
    </div>
    <div class="form-group">
      <label for="useDate">使用日 <span style="color:red;">(必須)</span></label>
      <input type="date" id="useDate" name="useDate" required />
    </div>
    <div class="form-group">
      <label for="applicationDate">申込日 (任意)</label>
      <input type="date" id="applicationDate" name="applicationDate" />
    </div>

    <!-- ▼ 学割特典 ▼ -->
    <div class="form-group">
      <label for="discountOption">利用する学割特典 <span style="color:red;">(必須)</span></label>
      <select id="discountOption" name="discountOption" required>
        <option value="">選択してください</option>
        <option value="早割">早割</option>
        <option value="いっしょ割">いっしょ割</option>
        <option value="リピータ割">リピータ割</option>
      </select>
    </div>

    <!-- ▼ 学校名/LINEの名前/クラス・団体名 ▼ -->
    <div class="form-group">
      <label for="schoolName">学校名 <span style="color:red;">(必須)</span></label>
      <input type="text" id="schoolName" name="schoolName" required />
    </div>
    <div class="form-group">
      <label for="lineName">LINEの名前 (任意)</label>
      <input type="text" id="lineName" name="lineName" />
    </div>
    <div class="form-group">
      <label for="classGroupName">クラス・団体名 <span style="color:red;">(必須)</span></label>
      <input type="text" id="classGroupName" name="classGroupName" required />
    </div>

    <!-- ▼ 郵便番号 (必須) & 学校(お届け)住所 ▼ -->
    <div class="form-group">
      <label for="zipCode">お届け先の郵便番号 <span style="color:red;">(必須)</span></label>
      <!-- 入力後にblurなどで住所自動入力関数を呼ぶ -->
      <input type="text" id="zipCode" name="zipCode" placeholder="例: 123-4567" required onblur="autoFillAddress()" />
    </div>
    <div class="form-group">
      <label for="address1">住所1 (都道府県・市区町村等)</label>
      <input type="text" id="address1" name="address1" />
    </div>
    <div class="form-group">
      <label for="address2">住所2 (番地以下) <span style="color:red;">(必須)</span></label>
      <input type="text" id="address2" name="address2" required />
    </div>
    <div class="form-group">
      <label for="schoolTel">学校TEL <span style="color:red;">(必須)</span></label>
      <input type="text" id="schoolTel" name="schoolTel" required />
    </div>

    <!-- ▼ 代表者情報 ▼ -->
    <div class="form-group">
      <label for="representativeName">代表者 <span style="color:red;">(必須)</span></label>
      <input type="text" id="representativeName" name="representativeName" required />
    </div>
    <div class="form-group">
      <label for="representativeTel">代表者TEL <span style="color:red;">(必須)</span></label>
      <input type="text" id="representativeTel" name="representativeTel" required />
    </div>
    <div class="form-group">
      <label for="representativeEmail">代表者メール (任意)</label>
      <input type="email" id="representativeEmail" name="representativeEmail" />
    </div>

    <!-- ▼ デザイン確認方法 ▼ -->
    <div class="form-group">
      <label for="designCheckMethod">デザイン確認方法 <span style="color:red;">(必須)</span></label>
      <select id="designCheckMethod" name="designCheckMethod" required>
        <option value="">選択してください</option>
        <option value="LINE代表者">LINE代表者</option>
        <option value="LINEご担任(保護者)">LINEご担任(保護者)</option>
        <option value="メール代表者">メール代表者</option>
        <option value="メールご担任(保護者)">メールご担任(保護者)</option>
      </select>
    </div>

    <!-- ▼ お支払い方法 ▼ -->
    <div class="form-group">
      <label for="paymentMethod">お支払い方法 <span style="color:red;">(必須)</span></label>
      <select id="paymentMethod" name="paymentMethod" required>
        <option value="">選択してください</option>
        <option value="代金引換">代金引換(ヤマト運輸/現金のみ)</option>
        <option value="コンビニ・郵便振替">コンビニ・郵便振替(後払い)</option>
        <option value="銀行振込(後払い)">銀行振込(後払い)</option>
        <option value="銀行振込(先払い)">銀行振込(先払い)</option>
      </select>
    </div>

    <div class="submit-btn">
      <button type="submit">送信</button>
    </div>
  </form>
</div>

<script>
  
  /**********************************************
   * 1) 製品テーブル（ご提示いただいたデータをすべて統合）
   **********************************************/
   const productTable = [
    // 5927-01 ゲームシャツ
    { productNo: "5927-01", productName: "ゲームシャツ", colorNo: "9816", colorName: "ホワイト/ホワイト/ブラック" },
    { productNo: "5927-01", productName: "ゲームシャツ", colorNo: "9887", colorName: "レッド/ホワイト/ブラック" },
    { productNo: "5927-01", productName: "ゲームシャツ", colorNo: "9889", colorName: "アイビーグリーン/ホワイト/ブラック" },
    { productNo: "5927-01", productName: "ゲームシャツ", colorNo: "9888", colorName: "コバルトブルー/ホワイト/ブラック" },
    { productNo: "5927-01", productName: "ゲームシャツ", colorNo: "9856", colorName: "ブラック/ホワイト/ブラック" },

    // 5982-01 ストライプドライベースボールシャツ / ドライベースボールシャツ
    { productNo: "5982-01", productName: "ストライプドライベースボールシャツ", colorNo: "1098", colorName: "ホワイト/ブラックストライプ" },
    { productNo: "5982-01", productName: "ストライプドライベースボールシャツ", colorNo: "2097", colorName: "ブラック/ホワイトストライプ" },

    { productNo: "5982-01", productName: "ドライベースボールシャツ", colorNo: "1002", colorName: "ホワイト/ブラック" },
    { productNo: "5982-01", productName: "ドライベースボールシャツ", colorNo: "1095", colorName: "ホワイト/マリンブルー" },
    { productNo: "5982-01", productName: "ドライベースボールシャツ", colorNo: "2001", colorName: "ブラック/ホワイト" },
    { productNo: "5982-01", productName: "ドライベースボールシャツ", colorNo: "2002", colorName: "ブラック/ブラック" },
    { productNo: "5982-01", productName: "ドライベースボールシャツ", colorNo: "6901", colorName: "ラベンダー/ホワイト" },
    { productNo: "5982-01", productName: "ドライベースボールシャツ", colorNo: "6001", colorName: "ターコイズブルー/ホワイト" },
    { productNo: "5982-01", productName: "ドライベースボールシャツ", colorNo: "4801", colorName: "マリンブルー/ホワイト" },
    { productNo: "5982-01", productName: "ドライベースボールシャツ", colorNo: "4001", colorName: "ネイビー/ホワイト" },
    { productNo: "5982-01", productName: "ドライベースボールシャツ", colorNo: "2602", colorName: "カナリアイエロー/ブラック" },
    { productNo: "5982-01", productName: "ドライベースボールシャツ", colorNo: "6402", colorName: "オレンジ/ブラック" },
    { productNo: "5982-01", productName: "ドライベースボールシャツ", colorNo: "6601", colorName: "トロピカルピンク/ホワイト" },
    { productNo: "5982-01", productName: "ドライベースボールシャツ", colorNo: "5602", colorName: "レッド/ブラック" },
    { productNo: "5982-01", productName: "ドライベースボールシャツ", colorNo: "5801", colorName: "バーガンディ/ホワイト" },
    { productNo: "5982-01", productName: "ドライベースボールシャツ", colorNo: "5001", colorName: "アイビーグリーン/ホワイト" },

    // ZD16 ストライプユニフォーム
    { productNo: "ZD16", productName: "ストライプユニフォーム", colorNo: "zd16223", colorName: "ホワイトxライトブルー" },
    { productNo: "ZD16", productName: "ストライプユニフォーム", colorNo: "zd16229", colorName: "ホワイトxライトパープル" },
    { productNo: "ZD16", productName: "ストライプユニフォーム", colorNo: "zd16230", colorName: "ホワイトxホットピンク" },
    { productNo: "ZD16", productName: "ストライプユニフォーム", colorNo: "zd16227", colorName: "ホワイトxパープル" },
    { productNo: "ZD16", productName: "ストライプユニフォーム", colorNo: "zd16226", colorName: "ホワイトxブラック" },
    { productNo: "ZD16", productName: "ストライプユニフォーム", colorNo: "zd16221", colorName: "レッドxブラック" },
    { productNo: "ZD16", productName: "ストライプユニフォーム", colorNo: "zd16224", colorName: "ブルーxブラック" },

    // 5992-01 バスケシャツ
    { productNo: "5992-01", productName: "バスケシャツ", colorNo: "9891", colorName: "ホワイト/ホワイト/レッド" },
    { productNo: "5992-01", productName: "バスケシャツ", colorNo: "9893", colorName: "レッド/ホワイト/レッド" },
    { productNo: "5992-01", productName: "バスケシャツ", colorNo: "9892", colorName: "カナリアイエロー/ホワイト/パープル" },
    { productNo: "5992-01", productName: "バスケシャツ", colorNo: "9890", colorName: "ブラック/ホワイト/ラベンダー" },
    { productNo: "5992-01", productName: "バスケシャツ", colorNo: "9856", colorName: "ブラック/ホワイト/ブラック" },

    // 300-ACT ドライTシャツ
    { productNo: "300-ACT", productName: "ドライTシャツ", colorNo: "001", colorName: "ホワイト" },
    { productNo: "300-ACT", productName: "ドライTシャツ", colorNo: "153", colorName: "シルバーグレー" },
    { productNo: "300-ACT", productName: "ドライTシャツ", colorNo: "002", colorName: "グレー" },
    { productNo: "300-ACT", productName: "ドライTシャツ", colorNo: "187", colorName: "ダークグレー" },
    { productNo: "300-ACT", productName: "ドライTシャツ", colorNo: "005", colorName: "ブラック" },
    { productNo: "300-ACT", productName: "ドライTシャツ", colorNo: "133", colorName: "ライトブルー" },
    { productNo: "300-ACT", productName: "ドライTシャツ", colorNo: "033", colorName: "サックス" },
    { productNo: "300-ACT", productName: "ドライTシャツ", colorNo: "034", colorName: "ターコイズブルー" },
    { productNo: "300-ACT", productName: "ドライTシャツ", colorNo: "198", colorName: "ミディアムブルー" },
    { productNo: "300-ACT", productName: "ドライTシャツ", colorNo: "032", colorName: "ロイヤルブルー" },
    { productNo: "300-ACT", productName: "ドライTシャツ", colorNo: "171", colorName: "ジャパンブルー" },
    { productNo: "300-ACT", productName: "ドライTシャツ", colorNo: "097", colorName: "インディゴ" },
    { productNo: "300-ACT", productName: "ドライTシャツ", colorNo: "027", colorName: "メロン" },
    { productNo: "300-ACT", productName: "ドライTシャツ", colorNo: "026", colorName: "ミントグリーン" },
    { productNo: "300-ACT", productName: "ドライTシャツ", colorNo: "096", colorName: "ミントブルー" },
    { productNo: "300-ACT", productName: "ドライTシャツ", colorNo: "024", colorName: "ライトグリーン" },
    { productNo: "300-ACT", productName: "ドライTシャツ", colorNo: "155", colorName: "ライム" },
    { productNo: "300-ACT", productName: "ドライTシャツ", colorNo: "194", colorName: "ブライトグリーン" },
    { productNo: "300-ACT", productName: "ドライTシャツ", colorNo: "025", colorName: "グリーン" },
    { productNo: "300-ACT", productName: "ドライTシャツ", colorNo: "138", colorName: "アイビーグリーン" },
    { productNo: "300-ACT", productName: "ドライTシャツ", colorNo: "128", colorName: "オリーブ" },
    { productNo: "300-ACT", productName: "ドライTシャツ", colorNo: "037", colorName: "アーミーグリーン" },
    { productNo: "300-ACT", productName: "ドライTシャツ", colorNo: "167", colorName: "メトロブルー" },
    { productNo: "300-ACT", productName: "ドライTシャツ", colorNo: "031", colorName: "ネイビー" },
    { productNo: "300-ACT", productName: "ドライTシャツ", colorNo: "455", colorName: "ライトベージュ" },
    { productNo: "300-ACT", productName: "ドライTシャツ", colorNo: "134", colorName: "ライトイエロー" },
    { productNo: "300-ACT", productName: "ドライTシャツ", colorNo: "020", colorName: "イエロー" },
    { productNo: "300-ACT", productName: "ドライTシャツ", colorNo: "165", colorName: "デイジー" },
    { productNo: "300-ACT", productName: "ドライTシャツ", colorNo: "015", colorName: "オレンジ" },
    { productNo: "300-ACT", productName: "ドライTシャツ", colorNo: "038", colorName: "サンセットオレンジ" },
    { productNo: "300-ACT", productName: "ドライTシャツ", colorNo: "132", colorName: "ライトピンク" },
    { productNo: "300-ACT", productName: "ドライTシャツ", colorNo: "011", colorName: "ピンク" },
    { productNo: "300-ACT", productName: "ドライTシャツ", colorNo: "146", colorName: "ホットピンク" },
    { productNo: "300-ACT", productName: "ドライTシャツ", colorNo: "010", colorName: "レッド" },
    { productNo: "300-ACT", productName: "ドライTシャツ", colorNo: "035", colorName: "ガーネットレッド" },
    { productNo: "300-ACT", productName: "ドライTシャツ", colorNo: "112", colorName: "バーガンディ" },
    { productNo: "300-ACT", productName: "ドライTシャツ", colorNo: "188", colorName: "ライトパープル" },
    { productNo: "300-ACT", productName: "ドライTシャツ", colorNo: "019", colorName: "ラベンダー" },
    { productNo: "300-ACT", productName: "ドライTシャツ", colorNo: "014", colorName: "パープル" },
    { productNo: "300-ACT", productName: "ドライTシャツ", colorNo: "236", colorName: "コヨーテ" },
    { productNo: "300-ACT", productName: "ドライTシャツ", colorNo: "047", colorName: "蛍光イエロー" },
    { productNo: "300-ACT", productName: "ドライTシャツ", colorNo: "048", colorName: "蛍光オレンジ" },
    { productNo: "300-ACT", productName: "ドライTシャツ", colorNo: "049", colorName: "蛍光ピンク" },

    // 5001-01 ハイクオリティTシャツ
    { productNo: "5001-01", productName: "ハイクオリティTシャツ", colorNo: "001", colorName: "ホワイト" },
    { productNo: "5001-01", productName: "ハイクオリティTシャツ", colorNo: "191", colorName: "バニラホワイト" },
    { productNo: "5001-01", productName: "ハイクオリティTシャツ", colorNo: "009", colorName: "オートミール" },
    { productNo: "5001-01", productName: "ハイクオリティTシャツ", colorNo: "005", colorName: "アッシュ" },
    { productNo: "5001-01", productName: "ハイクオリティTシャツ", colorNo: "010", colorName: "ライトグレー" },
    { productNo: "5001-01", productName: "ハイクオリティTシャツ", colorNo: "006", colorName: "ミックスグレー" },
    { productNo: "5001-01", productName: "ハイクオリティTシャツ", colorNo: "019", colorName: "ナチュラル" },
    { productNo: "5001-01", productName: "ハイクオリティTシャツ", colorNo: "545", colorName: "サンドベージュ" },
    { productNo: "5001-01", productName: "ハイクオリティTシャツ", colorNo: "053", colorName: "ライトベージュ" },
    { productNo: "5001-01", productName: "ハイクオリティTシャツ", colorNo: "537", colorName: "サンドカーキ" },
    { productNo: "5001-01", productName: "ハイクオリティTシャツ", colorNo: "052", colorName: "ダークブラウン" },
    { productNo: "5001-01", productName: "ハイクオリティTシャツ", colorNo: "072", colorName: "バーガンディ" },
    { productNo: "5001-01", productName: "ハイクオリティTシャツ", colorNo: "069", colorName: "レッド" },
    { productNo: "5001-01", productName: "ハイクオリティTシャツ", colorNo: "232", colorName: "ハイレッド" },
    { productNo: "5001-01", productName: "ハイクオリティTシャツ", colorNo: "511", colorName: "トロピカルピンク" },
    { productNo: "5001-01", productName: "ハイクオリティTシャツ", colorNo: "066", colorName: "ピンク" },
    { productNo: "5001-01", productName: "ハイクオリティTシャツ", colorNo: "574", colorName: "アプリコット" },
    { productNo: "5001-01", productName: "ハイクオリティTシャツ", colorNo: "576", colorName: "ベビーピンク" },
    { productNo: "5001-01", productName: "ハイクオリティTシャツ", colorNo: "495", colorName: "ライトピンク" },
    { productNo: "5001-01", productName: "ハイクオリティTシャツ", colorNo: "064", colorName: "オレンジ" },
    { productNo: "5001-01", productName: "ハイクオリティTシャツ", colorNo: "022", colorName: "ゴールド" },
    { productNo: "5001-01", productName: "ハイクオリティTシャツ", colorNo: "369", colorName: "バナナ" },
    { productNo: "5001-01", productName: "ハイクオリティTシャツ", colorNo: "190", colorName: "カナリアイエロー" },
    { productNo: "5001-01", productName: "ハイクオリティTシャツ", colorNo: "021", colorName: "イエロー" },
    { productNo: "5001-01", productName: "ハイクオリティTシャツ", colorNo: "487", colorName: "ライトイエロー" },
    { productNo: "5001-01", productName: "ハイクオリティTシャツ", colorNo: "037", colorName: "メロン" },
    { productNo: "5001-01", productName: "ハイクオリティTシャツ", colorNo: "024", colorName: "ミントグリーン" },
    { productNo: "5001-01", productName: "ハイクオリティTシャツ", colorNo: "575", colorName: "アップルグリーン" },
    { productNo: "5001-01", productName: "ハイクオリティTシャツ", colorNo: "029", colorName: "グリーン" },
    { productNo: "5001-01", productName: "ハイクオリティTシャツ", colorNo: "497", colorName: "アイビーグリーン" },
    { productNo: "5001-01", productName: "ハイクオリティTシャツ", colorNo: "739", colorName: "ライトオリーブ" },
    { productNo: "5001-01", productName: "ハイクオリティTシャツ", colorNo: "035", colorName: "シティグリーン" },
    { productNo: "5001-01", productName: "ハイクオリティTシャツ", colorNo: "488", colorName: "ライトブルー" },
    { productNo: "5001-01", productName: "ハイクオリティTシャツ", colorNo: "083", colorName: "アクアブルー" },
    { productNo: "5001-01", productName: "ハイクオリティTシャツ", colorNo: "538", colorName: "ターコイズブルー" },
    { productNo: "5001-01", productName: "ハイクオリティTシャツ", colorNo: "247", colorName: "アシッドブルー" },
    { productNo: "5001-01", productName: "ハイクオリティTシャツ", colorNo: "082", colorName: "サックス" },
    { productNo: "5001-01", productName: "ハイクオリティTシャツ", colorNo: "085", colorName: "ロイヤルブルー" },
    { productNo: "5001-01", productName: "ハイクオリティTシャツ", colorNo: "087", colorName: "インディゴ" },
    { productNo: "5001-01", productName: "ハイクオリティTシャツ", colorNo: "088", colorName: "スレート" },
    { productNo: "5001-01", productName: "ハイクオリティTシャツ", colorNo: "086", colorName: "ネイビー" },
    { productNo: "5001-01", productName: "ハイクオリティTシャツ", colorNo: "584", colorName: "ダークヘザーネイビー" },
    { productNo: "5001-01", productName: "ハイクオリティTシャツ", colorNo: "717", colorName: "ダークネイビー" },
    { productNo: "5001-01", productName: "ハイクオリティTシャツ", colorNo: "494", colorName: "ライトパープル" },
    { productNo: "5001-01", productName: "ハイクオリティTシャツ", colorNo: "076", colorName: "ラベンダー" },
    { productNo: "5001-01", productName: "ハイクオリティTシャツ", colorNo: "539", colorName: "バイオレットパープル" },
    { productNo: "5001-01", productName: "ハイクオリティTシャツ", colorNo: "062", colorName: "パープル" },
    { productNo: "5001-01", productName: "ハイクオリティTシャツ", colorNo: "007", colorName: "チャコール" },
    { productNo: "5001-01", productName: "ハイクオリティTシャツ", colorNo: "165", colorName: "スミ" },
    { productNo: "5001-01", productName: "ハイクオリティTシャツ", colorNo: "725", colorName: "ヘザーブラック" },
    { productNo: "5001-01", productName: "ハイクオリティTシャツ", colorNo: "002", colorName: "ブラック" },
    { productNo: "5001-01", productName: "ハイクオリティTシャツ", colorNo: "936", colorName: "ヘイジーレッド" },
    { productNo: "5001-01", productName: "ハイクオリティTシャツ", colorNo: "937", colorName: "ヘイジーイエロー" },
    { productNo: "5001-01", productName: "ハイクオリティTシャツ", colorNo: "935", colorName: "ヘイジーグリーン" },
    { productNo: "5001-01", productName: "ハイクオリティTシャツ", colorNo: "934", colorName: "ヘイジーネイビー" },
    { productNo: "5001-01", productName: "ハイクオリティTシャツ", colorNo: "933", colorName: "ヘイジーブラック" },

    // 302-ADP ドライポロシャツ
    { productNo: "302-ADP", productName: "ドライポロシャツ", colorNo: "001", colorName: "ホワイト" },
    { productNo: "302-ADP", productName: "ドライポロシャツ", colorNo: "002", colorName: "グレー" },
    { productNo: "302-ADP", productName: "ドライポロシャツ", colorNo: "187", colorName: "ダークグレー" },
    { productNo: "302-ADP", productName: "ドライポロシャツ", colorNo: "005", colorName: "ブラック" },
    { productNo: "302-ADP", productName: "ドライポロシャツ", colorNo: "133", colorName: "ライトブルー" },
    { productNo: "302-ADP", productName: "ドライポロシャツ", colorNo: "033", colorName: "サックス" },
    { productNo: "302-ADP", productName: "ドライポロシャツ", colorNo: "034", colorName: "ターコイズ" },
    { productNo: "302-ADP", productName: "ドライポロシャツ", colorNo: "032", colorName: "ロイヤルブルー" },
    { productNo: "302-ADP", productName: "ドライポロシャツ", colorNo: "171", colorName: "ジャパンブルー" },
    { productNo: "302-ADP", productName: "ドライポロシャツ", colorNo: "167", colorName: "メトロブルー" },
    { productNo: "302-ADP", productName: "ドライポロシャツ", colorNo: "031", colorName: "ネイビー" },
    { productNo: "302-ADP", productName: "ドライポロシャツ", colorNo: "134", colorName: "ライトイエロー" },
    { productNo: "302-ADP", productName: "ドライポロシャツ", colorNo: "020", colorName: "イエロー" },
    { productNo: "302-ADP", productName: "ドライポロシャツ", colorNo: "165", colorName: "デイジー" },
    { productNo: "302-ADP", productName: "ドライポロシャツ", colorNo: "015", colorName: "オレンジ" },
    { productNo: "302-ADP", productName: "ドライポロシャツ", colorNo: "038", colorName: "サンセットオレンジ" },
    { productNo: "302-ADP", productName: "ドライポロシャツ", colorNo: "132", colorName: "ライトピンク" },
    { productNo: "302-ADP", productName: "ドライポロシャツ", colorNo: "011", colorName: "ピンク" },
    { productNo: "302-ADP", productName: "ドライポロシャツ", colorNo: "146", colorName: "ホットピンク" },
    { productNo: "302-ADP", productName: "ドライポロシャツ", colorNo: "010", colorName: "レッド" },
    { productNo: "302-ADP", productName: "ドライポロシャツ", colorNo: "035", colorName: "ガーネットレッド" },
    { productNo: "302-ADP", productName: "ドライポロシャツ", colorNo: "112", colorName: "バーガンディ" },
    { productNo: "302-ADP", productName: "ドライポロシャツ", colorNo: "024", colorName: "ライトグリーン" },
    { productNo: "302-ADP", productName: "ドライポロシャツ", colorNo: "155", colorName: "ライム" },
    { productNo: "302-ADP", productName: "ドライポロシャツ", colorNo: "025", colorName: "グリーン" },

    // 303-ADP,304-ADP,... として分かれたデータ（実際は型番が異なる）
    { productNo: "303-ADP", productName: "ドライポロシャツ", colorNo: "037", colorName: "アーミーグリーン" },
    { productNo: "304-ADP", productName: "ドライポロシャツ", colorNo: "026", colorName: "ミントグリーン" },
    { productNo: "305-ADP", productName: "ドライポロシャツ", colorNo: "096", colorName: "ミントブルー" },
    { productNo: "306-ADP", productName: "ドライポロシャツ", colorNo: "188", colorName: "ライトパープル" },
    { productNo: "307-ADP", productName: "ドライポロシャツ", colorNo: "014", colorName: "パープル" },

    // 304-ALT ドライロングスリーブTシャツ
    { productNo: "304-ALT", productName: "ドライロングスリーブTシャツ", colorNo: "001", colorName: "ホワイト" },
    { productNo: "304-ALT", productName: "ドライロングスリーブTシャツ", colorNo: "002", colorName: "グレー" },
    { productNo: "304-ALT", productName: "ドライロングスリーブTシャツ", colorNo: "187", colorName: "ダークグレー" },
    { productNo: "304-ALT", productName: "ドライロングスリーブTシャツ", colorNo: "005", colorName: "ブラック" },
    { productNo: "304-ALT", productName: "ドライロングスリーブTシャツ", colorNo: "026", colorName: "ミントグリーン" },
    { productNo: "304-ALT", productName: "ドライロングスリーブTシャツ", colorNo: "133", colorName: "ライトブルー" },
    { productNo: "304-ALT", productName: "ドライロングスリーブTシャツ", colorNo: "034", colorName: "ターコイズ" },
    { productNo: "304-ALT", productName: "ドライロングスリーブTシャツ", colorNo: "032", colorName: "ロイヤルブルー" },
    { productNo: "304-ALT", productName: "ドライロングスリーブTシャツ", colorNo: "031", colorName: "ネイビー" },
    { productNo: "304-ALT", productName: "ドライロングスリーブTシャツ", colorNo: "014", colorName: "パープル" },
    { productNo: "304-ALT", productName: "ドライロングスリーブTシャツ", colorNo: "134", colorName: "ライトイエロー" },
    { productNo: "304-ALT", productName: "ドライロングスリーブTシャツ", colorNo: "165", colorName: "デイジー" },
    { productNo: "304-ALT", productName: "ドライロングスリーブTシャツ", colorNo: "015", colorName: "オレンジ" },
    { productNo: "304-ALT", productName: "ドライロングスリーブTシャツ", colorNo: "011", colorName: "ピンク" },
    { productNo: "304-ALT", productName: "ドライロングスリーブTシャツ", colorNo: "146", colorName: "ホットピンク" },
    { productNo: "304-ALT", productName: "ドライロングスリーブTシャツ", colorNo: "010", colorName: "レッド" },
    { productNo: "304-ALT", productName: "ドライロングスリーブTシャツ", colorNo: "112", colorName: "バーガンディ" },
    { productNo: "304-ALT", productName: "ドライロングスリーブTシャツ", colorNo: "024", colorName: "ライトグリーン" },
    { productNo: "304-ALT", productName: "ドライロングスリーブTシャツ", colorNo: "025", colorName: "グリーン" },
    { productNo: "304-ALT", productName: "ドライロングスリーブTシャツ", colorNo: "037", colorName: "アーミーグリーン" },

    // 219-MLC クルーネックライトトレーナー
    { productNo: "219-MLC", productName: "クルーネックライトトレーナー", colorNo: "001", colorName: "ホワイト" },
    { productNo: "219-MLC", productName: "クルーネックライトトレーナー", colorNo: "455", colorName: "ライトベージュ" },
    { productNo: "219-MLC", productName: "クルーネックライトトレーナー", colorNo: "039", colorName: "オートミール" },
    { productNo: "219-MLC", productName: "クルーネックライトトレーナー", colorNo: "003", colorName: "杢グレー" },
    { productNo: "219-MLC", productName: "クルーネックライトトレーナー", colorNo: "005", colorName: "ブラック" },
    { productNo: "219-MLC", productName: "クルーネックライトトレーナー", colorNo: "175", colorName: "オーシャンブルー" },
    { productNo: "219-MLC", productName: "クルーネックライトトレーナー", colorNo: "030", colorName: "ブルー" },
    { productNo: "219-MLC", productName: "クルーネックライトトレーナー", colorNo: "174", colorName: "ディープネイビー" },
    { productNo: "219-MLC", productName: "クルーネックライトトレーナー", colorNo: "481", colorName: "バイオレット" },
    { productNo: "219-MLC", productName: "クルーネックライトトレーナー", colorNo: "182", colorName: "カナリアイエロー" },
    { productNo: "219-MLC", productName: "クルーネックライトトレーナー", colorNo: "178", colorName: "フラミンゴピンク" },
    { productNo: "219-MLC", productName: "クルーネックライトトレーナー", colorNo: "172", colorName: "ブライトレッド" },
    { productNo: "219-MLC", productName: "クルーネックライトトレーナー", colorNo: "112", colorName: "バーガンディ" },
    // 220-MLC
    { productNo: "220-MLC", productName: "クルーネックライトトレーナー", colorNo: "029", colorName: "ケリーグリーン" },
    // 221-MLC
    { productNo: "221-MLC", productName: "クルーネックライトトレーナー", colorNo: "037", colorName: "アーミーグリーン" },

    // 217-MLZ ジップアップライトパーカー
    { productNo: "217-MLZ", productName: "ジップアップライトパーカー", colorNo: "001", colorName: "ホワイト" },
    { productNo: "217-MLZ", productName: "ジップアップライトパーカー", colorNo: "455", colorName: "ライトベージュ" },
    { productNo: "217-MLZ", productName: "ジップアップライトパーカー", colorNo: "039", colorName: "オートミール" },
    { productNo: "217-MLZ", productName: "ジップアップライトパーカー", colorNo: "003", colorName: "杢グレー" },
    { productNo: "217-MLZ", productName: "ジップアップライトパーカー", colorNo: "005", colorName: "ブラック" },
    { productNo: "217-MLZ", productName: "ジップアップライトパーカー", colorNo: "175", colorName: "オーシャンブルー" },
    { productNo: "217-MLZ", productName: "ジップアップライトパーカー", colorNo: "030", colorName: "ブルー" },
    { productNo: "217-MLZ", productName: "ジップアップライトパーカー", colorNo: "174", colorName: "ディープネイビー" },
    { productNo: "217-MLZ", productName: "ジップアップライトパーカー", colorNo: "481", colorName: "バイオレット" },
    { productNo: "217-MLZ", productName: "ジップアップライトパーカー", colorNo: "182", colorName: "カナリアイエロー" },
    { productNo: "217-MLZ", productName: "ジップアップライトパーカー", colorNo: "178", colorName: "フラミンゴピンク" },
    { productNo: "217-MLZ", productName: "ジップアップライトパーカー", colorNo: "172", colorName: "ブライトレッド" },
    { productNo: "217-MLZ", productName: "ジップアップライトパーカー", colorNo: "112", colorName: "バーガンディ" },
    { productNo: "217-MLZ", productName: "ジップアップライトパーカー", colorNo: "029", colorName: "ケリーグリーン" },
    { productNo: "217-MLZ", productName: "ジップアップライトパーカー", colorNo: "037", colorName: "アーミーグリーン" }
  ];


/**********************************************
 * (B) プリントカラー・オプション（全色 + 属性）
 **********************************************/
 const printColorOptions = [
  { name: "ホワイト", attribute: "レギュラーインク" },
  { name: "ライトグレー", attribute: "レギュラーインク" },
  { name: "ダークグレー", attribute: "レギュラーインク" },
  { name: "ブラック", attribute: "レギュラーインク" },
  { name: "サックス", attribute: "レギュラーインク" },
  { name: "ブルー", attribute: "レギュラーインク" },
  { name: "ネイビー", attribute: "レギュラーインク" },
  { name: "ライトピンク", attribute: "レギュラーインク" },
  { name: "ローズピンク", attribute: "レギュラーインク" },
  { name: "ホットピンク", attribute: "レギュラーインク" },
  { name: "レッド", attribute: "レギュラーインク" },
  { name: "ワインレッド", attribute: "レギュラーインク" },
  { name: "ミントグリーン", attribute: "レギュラーインク" },
  { name: "エメラルドグリーン", attribute: "レギュラーインク" },
  { name: "パステルイエロー", attribute: "レギュラーインク" },
  { name: "イエロー", attribute: "レギュラーインク" },
  { name: "ゴールドイエロー", attribute: "レギュラーインク" },
  { name: "オレンジ", attribute: "レギュラーインク" },
  { name: "イエローグリーン", attribute: "レギュラーインク" },
  { name: "グリーン", attribute: "レギュラーインク" },
  { name: "ダークグリーン", attribute: "レギュラーインク" },
  { name: "ライトパープル", attribute: "レギュラーインク" },
  { name: "パープル", attribute: "レギュラーインク" },
  { name: "クリーム", attribute: "レギュラーインク" },
  { name: "ライトブラウン", attribute: "レギュラーインク" },
  { name: "ダークブラウン", attribute: "レギュラーインク" },
  { name: "シルバー", attribute: "レギュラーインク" },
  { name: "ゴールド", attribute: "レギュラーインク" },
  { name: "グリッターシルバー", attribute: "オプションインク" },
  { name: "グリッターゴールド", attribute: "オプションインク" },
  { name: "グリッターブラック", attribute: "オプションインク" },
  { name: "グリッターイエロー", attribute: "オプションインク" },
  { name: "グリッターピンク", attribute: "オプションインク" },
  { name: "グリッターレッド", attribute: "オプションインク" },
  { name: "グリッターグリーン", attribute: "オプションインク" },
  { name: "グリッターブルー", attribute: "オプションインク" },
  { name: "グリッターパープル", attribute: "オプションインク" },
  { name: "蛍光イエロー", attribute: "オプションインク" },
  { name: "蛍光オレンジ", attribute: "オプションインク" },
  { name: "蛍光ピンク", attribute: "オプションインク" },
  { name: "蛍光グリーン", attribute: "オプションインク" },
  { name: "ネーム＆背番号セット", attribute: "ネーム＆背番号セット" },
  { name: "ネーム(大)", attribute: "ネーム(大)" },
  { name: "ネーム(小)", attribute: "ネーム(小)" },
  { name: "番号(大)", attribute: "番号(大)" },
  { name: "番号(小)", attribute: "番号(小)" },
];

  /**********************************************
   * (C) ネーム・番号用の「単色」と「フチ付き」カスタムで使う色一覧
   **********************************************/
  const nameNumberSingleColors = [
    "ホワイト","グレー","ネイビー","ブラック","ライトブルー","ブルー","イエロー","オレンジ",
    "ピンク","ホットピンク","レッド","パープル","ライトグリーン","グリーン","シルバー","ゴールド",
    "グリッターシルバー","グリッターゴールド","グリッターピンク","グリッターピンク"
  ];
  const nameNumberEdgeColors = [
    "ホワイト","グレー","ネイビー","ブラック","ライトブルー","ブルー","イエロー","オレンジ",
    "ピンク","ホットピンク","レッド","パープル","ライトグリーン","グリーン"
  ];

  // 各セレクト要素を取得
  const productNameSelect = document.getElementById("productNameSelect");
  const productNoSelect   = document.getElementById("productNoSelect");
  const colorNoSelect     = document.getElementById("colorNoSelect");
  const colorNameSelect   = document.getElementById("colorNameSelect");

  // 商品名リストを初期化
  function setProductNameOptions() {
    const names = Array.from(new Set(productTable.map(i=>i.productName)));
    productNameSelect.innerHTML = '<option value="">選択してください</option>';
    names.forEach(n => {
      const opt = document.createElement("option");
      opt.value = n;
      opt.textContent = n;
      productNameSelect.appendChild(opt);
    });
  }
  // 商品名→品番
  function setProductNoOptions() {
    const selectedName = productNameSelect.value;
    productNoSelect.innerHTML   = '<option value="">選択してください</option>';
    colorNoSelect.innerHTML     = '<option value="">選択してください</option>';
    colorNameSelect.innerHTML   = '<option value="">選択してください</option>';
    if (!selectedName) return;
    const nos = Array.from(
      new Set(
        productTable.filter(i=> i.productName===selectedName).map(i=> i.productNo)
      )
    );
    nos.forEach(n=>{
      const opt = document.createElement("option");
      opt.value = n;
      opt.textContent = n;
      productNoSelect.appendChild(opt);
    });
  }
  // 品番→カラーNo
  function setColorNoOptions() {
    const selectedName = productNameSelect.value;
    const selectedNo   = productNoSelect.value;
    colorNoSelect.innerHTML   = '<option value="">選択してください</option>';
    colorNameSelect.innerHTML = '<option value="">選択してください</option>';
    if(!selectedName || !selectedNo) return;
    const cNos = Array.from(
      new Set(
        productTable
          .filter(i=> i.productName===selectedName && i.productNo===selectedNo)
          .map(i=> i.colorNo)
      )
    );
    cNos.forEach(cn=>{
      const opt = document.createElement("option");
      opt.value = cn;
      opt.textContent = cn;
      colorNoSelect.appendChild(opt);
    });
  }
  // カラーNo→カラー名
  function setColorNameOptions() {
    const selectedName = productNameSelect.value;
    const selectedNo   = productNoSelect.value;
    const selectedCno  = colorNoSelect.value;
    colorNameSelect.innerHTML = '<option value="">選択してください</option>';
    if(!selectedName || !selectedNo || !selectedCno) return;
    const matches = productTable.filter(i=>
      i.productName===selectedName && i.productNo===selectedNo && i.colorNo===selectedCno
    );
    matches.forEach(m=>{
      const opt = document.createElement("option");
      opt.value = m.colorName;
      opt.textContent = m.colorName;
      colorNameSelect.appendChild(opt);
    });
    if(matches.length===1) colorNameSelect.selectedIndex=1;
  }

  // プリントカラーセレクト(1色目/2色目/3色目)を生成
  function populatePrintColorSelects(baseId) {
    // baseId: たとえば "printColorOption1_" のような接頭辞
    ["1","2","3"].forEach(num=>{
      const selId = baseId + num;  // 例: "printColorOption1_1"
      const sel = document.getElementById(selId);
      if(!sel) return;
      sel.innerHTML = `<option value="">${num}色目を選択</option>`;
      printColorOptions.forEach(col=>{
        const opt = document.createElement("option");
        opt.value = col.name;
        opt.textContent = col.name + (col.attribute==="オプションインク" ? " (オプション)" : "");
        sel.appendChild(opt);
      });
    });
  }

  // ネーム・番号プリント時の表示切替
  function toggleNameNumberOptions(idx) {
    const sel = document.getElementById("printPositionNo" + idx);
    const val = sel.value;
    const box = document.getElementById("nameNumberOptions" + idx);
    if(val==="6" || val==="7"){
      box.classList.remove("hidden");
    } else {
      box.classList.add("hidden");
      // さらに色設定のボックスも隠す
      document.getElementById("nameNumberPrintColorBox"+idx).classList.add("hidden");
    }
  }
  // ネーム＆番号プリントの種類
  function toggleNameNumberColorBox(idx) {
    const sel = document.getElementById("nameNumberOption"+idx);
    const val = sel.value;
    const box = document.getElementById("nameNumberPrintColorBox"+idx);
    if(val) {
      box.classList.remove("hidden");
    } else {
      box.classList.add("hidden");
    }
  }

  // 単色 or フチ付き
  function toggleEdgeColor(idx) {
    const radios = document.getElementsByName("nameNumberPrintType"+idx);
    let selected = "single";
    radios.forEach(r=>{ if(r.checked) selected=r.value; });
    const singleDiv = document.getElementById("singleColorSelectArea"+idx);
    const edgeDiv   = document.getElementById("edgeColorSelectArea"+idx);
    if(selected==="single"){
      singleDiv.classList.remove("hidden");
      edgeDiv.classList.add("hidden");
    } else {
      singleDiv.classList.add("hidden");
      edgeDiv.classList.remove("hidden");
    }
  }

  // フチ付きタイプを変更
  function changeEdgeType(idx) {
    const sel = document.getElementById("edgeType"+idx);
    const val = sel.value;
    const customArea = document.getElementById("edgeColorCustomArea"+idx);
    const textColor = document.getElementById("edgeCustomTextColor"+idx);
    const edge1 = document.getElementById("edgeCustomEdgeColor"+idx);
    const edge2 = document.getElementById("edgeCustomEdgeColor2_"+idx);

    if(val==="custom"){
      customArea.classList.remove("hidden");
      textColor.value="";
      edge1.value="";
      edge2.value="";
    } else {
      customArea.classList.add("hidden");
      // FT-1 ～ FT-8
      switch(val){
        case "FT-1":
          textColor.value="ブラック"; edge1.value="ブラック"; edge2.value="";
          break;
        case "FT-2":
          textColor.value="ホワイト"; edge1.value="ブラック"; edge2.value="";
          break;
        case "FT-3":
          textColor.value="レッド"; edge1.value="ブラック"; edge2.value="";
          break;
        case "FT-4":
          textColor.value="パープル"; edge1.value="イエロー"; edge2.value="";
          break;
        case "FT-5":
          textColor.value="ブラック"; edge1.value="ホワイト"; edge2.value="ブラック";
          break;
        case "FT-6":
          textColor.value="レッド"; edge1.value="ホワイト"; edge2.value="ブラック";
          break;
        case "FT-7":
          textColor.value="ブルー"; edge1.value="ホワイト"; edge2.value="ブルー";
          break;
        case "FT-8":
          textColor.value="ブルー"; edge1.value="ホワイト"; edge2.value="レッド";
          break;
      }
    }
  }

  // フォント選択（英数字/日本語）
  function handleFontRadio(idx) {
    const eRadio = document.querySelector(`input[name="fontType${idx}"][value="E"]`);
    const prefix = document.getElementById("fontPrefix"+idx);
    if(eRadio && eRadio.checked){
      prefix.textContent = "E-";
    } else {
      prefix.textContent = "J-";
    }
  }

  // デザインサイズの切り替え
  function toggleCustomSize(idx){
    const sel = document.getElementById("designSize"+idx);
    const cDiv = document.getElementById("customSizeInput"+idx);
    if(sel.value==="custom"){
      cDiv.classList.remove("hidden");
    } else {
      cDiv.classList.add("hidden");
    }
  }

  // 合計枚数計算
  function calculateTotal(){
    const sizeIds = ["size150","sizeSS","sizeS","sizeM","sizeL","sizeXL","sizeXXL"];
    let total=0;
    sizeIds.forEach(id=>{
      const val = parseInt(document.getElementById(id).value)||0;
      total+=val;
    });
    document.getElementById("totalQuantity").value = total;
  }

  /**********************************************
   * (D) 追加プリント箇所を動的に増やす
   **********************************************/
  let printLocationCount = 1;  // 最初は1箇所目がある
  function addPrintLocation(){
    if(printLocationCount>=4){
      alert("最大4ヵ所までです。");
      return;
    }
    printLocationCount++;
    const idx = printLocationCount; // 2,3,4

    // 複製: 1ヵ所目のHTMLをベースにするか、あらかじめテンプレートを用意する方法も可
    // ここでは簡単のためテンプレート文字列で用意
    const html = `
      <fieldset id="printLocation${idx}">
        <legend>${idx}ヵ所目のプリント設定</legend>
        <div class="sub-group">
          <label for="printPositionNo${idx}">プリント位置No.</label>
          <select id="printPositionNo${idx}" name="printPositionNo${idx}" onchange="toggleNameNumberOptions(${idx})">
            <option value="">選択</option>
            <option value="1">1</option><option value="2">2</option><option value="3">3</option>
            <option value="4">4</option><option value="5">5</option><option value="6">6</option><option value="7">7</option>
          </select>
        </div>
        <div id="nameNumberOptions${idx}" class="sub-group hidden">
          <label>ネーム＆番号プリント</label>
          <select name="nameNumberOption${idx}" id="nameNumberOption${idx}" onchange="toggleNameNumberColorBox(${idx})">
            <option value="">選択</option>
            <option value="nameNumberSet">ネーム＆背番号セット</option>
            <option value="nameLarge">ネーム(大)</option>
            <option value="nameSmall">ネーム(小)</option>
            <option value="numberLarge">番号(大)</option>
            <option value="numberSmall">番号(小)</option>
          </select>
        </div>
        <div id="nameNumberPrintColorBox${idx}" class="sub-group hidden" style="border:1px solid #ccc; padding:0.5em;">
          <strong>ネーム・番号プリントカラーオプション</strong>
          <div class="inline-flex mt1 mb1">
            <label><input type="radio" name="nameNumberPrintType${idx}" value="single" checked onclick="toggleEdgeColor(${idx})"> 単色</label>
            <label><input type="radio" name="nameNumberPrintType${idx}" value="edge" onclick="toggleEdgeColor(${idx})"> フチ付き</label>
          </div>
          <div id="singleColorSelectArea${idx}" class="sub-group">
            <label>単色カラー</label>
            <select id="singleColor${idx}" name="singleColor${idx}"></select>
          </div>
          <div id="edgeColorSelectArea${idx}" class="sub-group hidden">
            <label>フチ付きタイプ</label>
            <select id="edgeType${idx}" name="edgeType${idx}" onchange="changeEdgeType(${idx})">
              <option value="">選択してください</option>
              <option value="FT-1">FT-1 (文字色ブラック、フチ色1ブラック)</option>
              <option value="FT-2">FT-2 (文字色ホワイト、フチ色1ブラック)</option>
              <option value="FT-3">FT-3 (文字色レッド、フチ色1ブラック)</option>
              <option value="FT-4">FT-4 (文字色パープル、フチ色1イエロー)</option>
              <option value="FT-5">FT-5 (文字色ブラック、フチ色1ホワイト、フチ色2ブラック)</option>
              <option value="FT-6">FT-6 (文字色レッド、フチ色1ホワイト、フチ色2ブラック)</option>
              <option value="FT-7">FT-7 (文字色ブルー、フチ色1ホワイト、フチ色2ブルー)</option>
              <option value="FT-8">FT-8 (文字色ブルー、フチ色1ホワイト、フチ色2レッド)</option>
              <option value="custom">カスタム</option>
            </select>
            <div id="edgeColorCustomArea${idx}" class="hidden" style="margin-top:0.5em;">
              <label>文字色</label>
              <select id="edgeCustomTextColor${idx}" name="edgeCustomTextColor${idx}"></select>
              <label>フチ色1</label>
              <select id="edgeCustomEdgeColor${idx}" name="edgeCustomEdgeColor${idx}"></select>
              <label>フチ色2 (任意)</label>
              <select id="edgeCustomEdgeColor2_${idx}" name="edgeCustomEdgeColor2_${idx}"></select>
            </div>
          </div>
          <div class="sub-group mt1">
            <label>フォント選択</label>
            <div class="inline-flex mb1">
              <label><input type="radio" name="fontType${idx}" value="E" checked> 英数字対応 (E-)</label>
              <label><input type="radio" name="fontType${idx}" value="J"> 日本語対応 (J-)</label>
            </div>
            <div class="inline-flex">
              <span id="fontPrefix${idx}">E-</span>
              <input type="text" id="fontNumber${idx}" name="fontNumber${idx}" maxlength="2" style="width:3em;" placeholder="00">
            </div>
          </div>
        </div>
        <div class="sub-group">
          <label>プリントカラー・オプション</label>
          <select name="printColorOption${idx}_1" id="printColorOption${idx}_1">
            <option value="">1色目を選択</option>
          </select>
          <select name="printColorOption${idx}_2" id="printColorOption${idx}_2">
            <option value="">2色目を選択</option>
          </select>
          <select name="printColorOption${idx}_3" id="printColorOption${idx}_3">
            <option value="">3色目を選択</option>
          </select>
          <select name="fullColorSize${idx}">
            <option value="">フルカラーを選択</option>
            <option value="S">フルカラー(小)</option>
            <option value="M">フルカラー(中)</option>
            <option value="L">フルカラー(大)</option>
          </select>
        </div>
        <div class="sub-group">
          <label for="designCode${idx}">デザイン (例: D-001)</label>
          <div style="display:flex; gap:0.3em;">
            <span>D-</span>
            <input type="text" id="designCode${idx}" name="designCode${idx}" maxlength="3" style="width:4em;" placeholder="3桁">
          </div>
        </div>
        <div class="sub-group">
          <label>デザインサイズ</label>
          <select name="designSize${idx}" id="designSize${idx}" onchange="toggleCustomSize(${idx})">
            <option value="max">プリント位置最大</option>
            <option value="custom">任意のサイズ</option>
          </select>
          <div id="customSizeInput${idx}" class="hidden">
            <label>X(cm)</label>
            <input type="number" name="designSizeX${idx}" min="0" step="0.1" style="width:5em;">
            <label>Y(cm)</label>
            <input type="number" name="designSizeY${idx}" min="0" step="0.1" style="width:5em;">
          </div>
        </div>
      </fieldset>
    `;
    const container = document.getElementById("additionalPrintLocations");
    // 追加
    const div = document.createElement("div");
    div.innerHTML = html;
    container.appendChild(div);

    // 追加直後に、プリントカラーのセレクトボックスへオプションをセット
    populatePrintColorSelects(`printColorOption${idx}_`);
    // ネーム＆番号プリントの単色/フチ付き用カラー選択肢をセット
    fillNameNumberColors(`singleColor${idx}`, nameNumberSingleColors);
    fillNameNumberColors(`edgeCustomTextColor${idx}`, nameNumberEdgeColors);
    fillNameNumberColors(`edgeCustomEdgeColor${idx}`, nameNumberEdgeColors);
    fillNameNumberColors(`edgeCustomEdgeColor2_${idx}`, nameNumberEdgeColors);

    // フォント選択ラジオを監視
    const fontRadios = document.getElementsByName(`fontType${idx}`);
    fontRadios.forEach(r=>{
      r.addEventListener("change",()=>handleFontRadio(idx));
    });
  }

  function fillNameNumberColors(selectId, colorArray){
    const el = document.getElementById(selectId);
    if(!el) return;
    el.innerHTML = '<option value="">選択してください</option>';
    colorArray.forEach(c=>{
      const opt = document.createElement("option");
      opt.value = c;
      opt.textContent = c;
      el.appendChild(opt);
    });
  }

  /**********************************************
   * (E) 郵便番号 → 住所1 自動入力（サンプル）
   **********************************************/
   function autoFillAddress(){
    const zip = document.getElementById("zipCode").value.trim();
    if(!zip) return;

    fetch('https://zipcloud.ibsnet.co.jp/api/search?zipcode=' + encodeURIComponent(zip))
      .then(response => response.json())
      .then(data => {
        // ZipCloudのレスポンス
        // data.status === 200 かつ data.results がある場合に取得成功
        if(data.status === 200 && data.results && data.results.length > 0) {
          const result = data.results[0];
          // address1: 都道府県, address2: 市区町村, address3: 町域
          const fullAddress = result.address1 + result.address2 + result.address3;
          document.getElementById("address1").value = fullAddress;
        } else {
          alert("該当する住所が見つかりませんでした。");
        }
      })
      .catch(err => {
        console.error(err);
        alert("住所検索に失敗しました。");
      });
  }

  /**********************************************
   * ページ読み込み時の初期処理
   **********************************************/
  window.addEventListener("DOMContentLoaded",()=>{
    // 商品名リスト
    setProductNameOptions();
    // 1ヵ所目のプリントカラーセレクト
    populatePrintColorSelects("printColorOption1_");
    // 1ヵ所目のネーム&番号用カラー
    fillNameNumberColors("singleColor1", nameNumberSingleColors);
    fillNameNumberColors("edgeCustomTextColor1", nameNumberEdgeColors);
    fillNameNumberColors("edgeCustomEdgeColor1", nameNumberEdgeColors);
    fillNameNumberColors("edgeCustomEdgeColor2_1", nameNumberEdgeColors);

    // フォント選択ラジオを監視(1ヵ所目)
    const fontRadios1 = document.getElementsByName("fontType1");
    fontRadios1.forEach(r=>{
      r.addEventListener("change",()=>handleFontRadio(1));
    });

    // 商品名/品番/カラーNo変更時のイベント
    productNameSelect.addEventListener("change", setProductNoOptions);
    productNoSelect.addEventListener("change", setColorNoOptions);
    colorNoSelect.addEventListener("change", setColorNameOptions);
  });
      // ページロード後に LIFF 初期化
      document.addEventListener("DOMContentLoaded", async () => {
      try {
        await liff.init({ liffId: "{{ liff_id }}" });      // ← Flask から渡した変数
        // プロフィール取得で userId を取得
        const profile = await liff.getProfile();
        document.getElementById("lineUserId").value = profile.userId;
      } catch(e) {
        console.error("LIFF error", e);
        alert("LINEログインに失敗しました。");
      }
    });
</script>
</body>
</html>
